-----------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp3-EnergyIneq/Code/05_merge_fred_data.log
  log type:  text
 opened on:   9 Jan 2026, 07:34:08

. 
. ****************************************************
. * 1. Import 1-year Treasury yield (GS1)
. ****************************************************
. import delimited "$fred/GS1.csv", clear
(encoding automatically selected: ISO-8859-1)
(2 vars, 336 obs)

. 
. * Parse date and create quarterly date
. gen date = date(observation_date, "YMD")

. format date %td

. gen year = year(date)

. gen month = month(date)

. gen quarter = ceil(month/3)

. gen qdate = yq(year, quarter)

. format qdate %tq

. 
. * Rename variable (Stata converts CSV headers to lowercase)
. rename gs1 treasury_1yr

. 
. * Collapse to quarterly (average monthly rates)
. collapse (mean) treasury_1yr, by(qdate year quarter)

. 
. * Save temporary file
. tempfile gs1

. save `gs1'
file /var/folders/17/1rg0y2kj74l9p9g301vbhhkw0000gn/T//S_28270.000001 saved as .dta format

. 
. display "Imported GS1: " _N " quarterly observations"
Imported GS1: 112 quarterly observations

. 
. ****************************************************
. * 2. Import Industrial Production (INDPRO)
. ****************************************************
. import delimited "$fred/INDPRO.csv", clear
(encoding automatically selected: ISO-8859-1)
(2 vars, 336 obs)

. 
. * Parse date and create quarterly date
. gen date = date(observation_date, "YMD")

. format date %td

. gen year = year(date)

. gen month = month(date)

. gen quarter = ceil(month/3)

. gen qdate = yq(year, quarter)

. format qdate %tq

. 
. * Rename variable and take log (Stata converts CSV headers to lowercase)
. rename indpro indpro_raw

. gen log_indpro = log(indpro_raw)

. drop indpro_raw

. 
. * Collapse to quarterly (average of log levels)
. collapse (mean) log_indpro, by(qdate year quarter)

. 
. * Save temporary file
. tempfile indpro

. save `indpro'
file /var/folders/17/1rg0y2kj74l9p9g301vbhhkw0000gn/T//S_28270.000002 saved as .dta format

. 
. display "Imported INDPRO: " _N " quarterly observations"
Imported INDPRO: 112 quarterly observations

. 
. ****************************************************
. * 3. Import Headline CPI (CPIAUCSL)
. ****************************************************
. import delimited "$fred/CPIAUCSL.csv", clear
(encoding automatically selected: ISO-8859-1)
(2 vars, 336 obs)

. 
. * Parse date and create quarterly date
. gen date = date(observation_date, "YMD")

. format date %td

. gen year = year(date)

. gen month = month(date)

. gen quarter = ceil(month/3)

. gen qdate = yq(year, quarter)

. format qdate %tq

. 
. * Rename variable and take log (Stata converts CSV headers to lowercase)
. rename cpiaucsl cpi_headline_raw

. gen log_cpi_headline = log(cpi_headline_raw)

. drop cpi_headline_raw

. 
. * Collapse to quarterly (average of log levels)
. collapse (mean) log_cpi_headline, by(qdate year quarter)

. 
. * Compute quarterly inflation as log difference
. sort qdate

. gen infl_headline = log_cpi_headline - log_cpi_headline[_n-1]
(1 missing value generated)

. 
. * Save temporary file
. tempfile cpi_headline

. save `cpi_headline'
file /var/folders/17/1rg0y2kj74l9p9g301vbhhkw0000gn/T//S_28270.000003 saved as .dta format

. 
. display "Imported CPIAUCSL: " _N " quarterly observations"
Imported CPIAUCSL: 112 quarterly observations

. 
. ****************************************************
. * 4. Import Core CPI (CPILFESL)
. ****************************************************
. import delimited "$fred/CPILFESL.csv", clear
(encoding automatically selected: ISO-8859-1)
(2 vars, 336 obs)

. 
. * Parse date and create quarterly date
. gen date = date(observation_date, "YMD")

. format date %td

. gen year = year(date)

. gen month = month(date)

. gen quarter = ceil(month/3)

. gen qdate = yq(year, quarter)

. format qdate %tq

. 
. * Rename variable and take log (Stata converts CSV headers to lowercase)
. rename cpilfesl cpi_core_raw

. gen log_cpi_core = log(cpi_core_raw)

. drop cpi_core_raw

. 
. * Collapse to quarterly (average of log levels)
. collapse (mean) log_cpi_core, by(qdate year quarter)

. 
. * Compute quarterly inflation as log difference
. sort qdate

. gen infl_core = log_cpi_core - log_cpi_core[_n-1]
(1 missing value generated)

. 
. * Save temporary file
. tempfile cpi_core

. save `cpi_core'
file /var/folders/17/1rg0y2kj74l9p9g301vbhhkw0000gn/T//S_28270.000004 saved as .dta format

. 
. display "Imported CPILFESL: " _N " quarterly observations"
Imported CPILFESL: 112 quarterly observations

. 
. ****************************************************
. * 5. Import Unemployment Rate (UNRATE)
. ****************************************************
. import delimited "$fred/UNRATE.csv", clear
(encoding automatically selected: ISO-8859-1)
(2 vars, 336 obs)

. 
. * Parse date and create quarterly date
. gen date = date(observation_date, "YMD")

. format date %td

. gen year = year(date)

. gen month = month(date)

. gen quarter = ceil(month/3)

. gen qdate = yq(year, quarter)

. format qdate %tq

. 
. * Variable is already lowercase (no rename needed)
. * unrate is the variable name
. 
. * Collapse to quarterly (average monthly rates)
. collapse (mean) unrate, by(qdate year quarter)

. 
. * Save temporary file
. tempfile unrate

. save `unrate'
file /var/folders/17/1rg0y2kj74l9p9g301vbhhkw0000gn/T//S_28270.000005 saved as .dta format

. 
. display "Imported UNRATE: " _N " quarterly observations"
Imported UNRATE: 112 quarterly observations

. 
. ****************************************************
. * 6. Merge all FRED data together
. ****************************************************
. use `gs1', clear

. 
. merge 1:1 qdate using `indpro'

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               112  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. merge 1:1 qdate using `cpi_headline'

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               112  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. merge 1:1 qdate using `cpi_core'

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               112  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. merge 1:1 qdate using `unrate'

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               112  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. * Save combined FRED data
. save "$deriv/fred_quarterly.dta", replace
file /Volumes/SSD PRO/Github-forks/Chp3-EnergyIneq/Code/Data/CEX/derived/fred_quarterly.dta
    saved

. 
. display _n "=== FRED DATA SUMMARY ==="

=== FRED DATA SUMMARY ===

. describe

Contains data from /Volumes/SSD PRO/Github-forks/Chp3-EnergyIneq/Code/Data/CEX/derived/fred_qua
> rterly.dta
 Observations:           112                  
    Variables:            10                  9 Jan 2026 07:34
-----------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-----------------------------------------------------------------------------------------------
year            float   %9.0g                 
quarter         float   %9.0g                 
qdate           float   %tq                   
treasury_1yr    float   %9.0g                 (mean) treasury_1yr
log_indpro      float   %9.0g                 (mean) log_indpro
log_cpi_headl~e float   %9.0g                 (mean) log_cpi_headline
infl_headline   float   %9.0g                 
log_cpi_core    float   %9.0g                 (mean) log_cpi_core
infl_core       float   %9.0g                 
unrate          float   %9.0g                 (mean) unrate
-----------------------------------------------------------------------------------------------
Sorted by: qdate

. summarize qdate

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       qdate |        112       199.5    32.47563        144        255

. list in 1/10

     +--------------------------------------------------------------------------------+
  1. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1996 |       1 | 1996q1 | 5.123333 | 4.294415 | 5.043853 |        . | 5.100068 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |                      .                |                5.533333                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
  2. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1996 |       2 | 1996q2 | 5.663333 | 4.315837 | 5.052416 |  .008563 | 5.105944 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0058756                |                     5.5                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
  3. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1996 |       3 | 1996q3 | 5.783333 | 4.329019 | 5.058153 | .0057373 | 5.112387 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0064435                |                5.266666                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
  4. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1996 |       4 | 1996q4 |     5.48 | 4.343401 | 5.066803 | .0086498 | 5.118791 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0064034                |                5.333333                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
  5. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1997 |       1 | 1997q1 | 5.646667 | 4.362312 | 5.072879 | .0060759 | 5.124558 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0057673                |                5.233333                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
  6. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1997 |       2 | 1997q2 |     5.85 | 4.376868 | 5.075173 | .0022945 | 5.130884 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0063257                |                       5                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
  7. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1997 |       3 | 1997q3 |     5.54 | 4.399949 | 5.080159 | .0049858 | 5.135209 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0043254                |                4.866667                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
  8. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1997 |       4 | 1997q4 | 5.483334 | 4.424819 | 5.085536 | .0053773 | 5.140882 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0056734                |                4.666667                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
  9. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1998 |       1 | 1998q1 | 5.313333 | 4.435836 | 5.087596 | .0020599 | 5.146912 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0060296                |                4.633333                |
     +--------------------------------------------------------------------------------+

     +--------------------------------------------------------------------------------+
 10. | year | quarter |  qdate | treasu~r | log_in~o | log_c~ne | infl_h~e | log_c~re |
     | 1998 |       2 | 1998q2 |     5.41 | 4.442409 | 5.090882 | .0032854 | 5.152519 |
     |--------------------------------------------------------------------------------|
     |               infl_c~e                |                  unrate                |
     |               .0056071                |                     4.4                |
     +--------------------------------------------------------------------------------+

. 
. ****************************************************
. * 7. Merge with existing Gini-BH shocks dataset
. ****************************************************
. use "$deriv/gini_bh_shocks_merged.dta", clear

. 
. display _n "=== GINI-BH SHOCKS DATA ==="

=== GINI-BH SHOCKS DATA ===

. count
  112

. summarize qdate

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       qdate |        112       199.5    32.47563        144        255

. 
. * Merge with FRED data
. merge 1:1 qdate using "$deriv/fred_quarterly.dta"

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               112  (_merge==3)
    -----------------------------------------

. 
. display _n "=== MERGE RESULTS ==="

=== MERGE RESULTS ===

. tab _merge

   Matching result from |
                  merge |      Freq.     Percent        Cum.
------------------------+-----------------------------------
            Matched (3) |        112      100.00      100.00
------------------------+-----------------------------------
                  Total |        112      100.00

. 
. * Keep only matched observations (or adjust as needed)
. keep if _merge == 3
(0 observations deleted)

. drop _merge

. 
. * Sort and order variables
. sort qdate

. order qdate year quarter gini_core gini_broad demand_shock_agg demand_shock_oil supply_shock 
> ///
>     treasury_1yr log_indpro log_cpi_headline log_cpi_core infl_headline infl_core unrate

. 
. * Add variable labels
. label var treasury_1yr "1-year Treasury yield (%)"

. label var log_indpro "Log Industrial Production (quarterly average)"

. label var log_cpi_headline "Log Headline CPI (quarterly average)"

. label var log_cpi_core "Log Core CPI (quarterly average)"

. label var infl_headline "Headline inflation (quarterly, log difference)"

. label var infl_core "Core inflation (quarterly, log difference)"

. label var unrate "Unemployment rate (%)"

. 
. * Save final merged dataset
. save "$deriv/gini_bh_shocks_fred_merged.dta", replace
file /Volumes/SSD
    PRO/Github-forks/Chp3-EnergyIneq/Code/Data/CEX/derived/gini_bh_shocks_fred_merged.dta
    saved

. 
. display _n "=== FINAL MERGED DATASET ==="

=== FINAL MERGED DATASET ===

. describe

Contains data from /Volumes/SSD PRO/Github-forks/Chp3-EnergyIneq/Code/Data/CEX/derived/gini_bh_
> shocks_fred_merged.dta
 Observations:           112                  
    Variables:            17                  9 Jan 2026 07:34
-----------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-----------------------------------------------------------------------------------------------
qdate           float   %tq                   Stata quarterly date
year            float   %8.0g                 Year
quarter         float   %8.0g                 Quarter (. = annual)
gini_core       double  %10.0g                Gini coefficient - core consumption
gini_broad      double  %10.0g                Gini coefficient - broad consumption
demand_shock_~g double  %10.0g                BH aggregate demand shock (economic activity)
demand_shock_~l double  %10.0g                BH oil consumption demand shock (oil market)
supply_shock    double  %10.0g                BH supply shock
treasury_1yr    float   %9.0g                 1-year Treasury yield (%)
log_indpro      float   %9.0g                 Log Industrial Production (quarterly average)
log_cpi_headl~e float   %9.0g                 Log Headline CPI (quarterly average)
log_cpi_core    float   %9.0g                 Log Core CPI (quarterly average)
infl_headline   float   %9.0g                 Headline inflation (quarterly, log difference)
infl_core       float   %9.0g                 Core inflation (quarterly, log difference)
unrate          float   %9.0g                 Unemployment rate (%)
gini_fincbtax   double  %10.0g                Gini coefficient - income before taxes
gini_fsalaryx   double  %10.0g                Gini coefficient - salary income
-----------------------------------------------------------------------------------------------
Sorted by: qdate

. count
  112

. local n_final = r(N)

. display _n "First 10 observations:"

First 10 observations:

. list in 1/10

     +----------------------------------------------------------------------------------------+
  1. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1996q1 | 1996 |       1 | .55468213 | .49419832 | -.22148647 |  .46885808 | -.32788254 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 5.123333 | 4.294415 | 5.043853 | 5.100068 |        . |        . | 5.533333 | .48794494 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                        .4469206                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
  2. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1996q2 | 1996 |       2 | .56675941 | .50503184 |  .12724921 | -.83489113 | -.01555055 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 5.663333 | 4.315837 | 5.052416 | 5.105944 |  .008563 | .0058756 |      5.5 | .48039882 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .44027883                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
  3. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1996q3 | 1996 |       3 | .57520928 | .51438453 |   .1036368 |  2.4496306 | -.46768384 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 5.783333 | 4.329019 | 5.058153 | 5.112387 | .0057373 | .0064435 | 5.266666 | .47925651 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                        .4351627                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
  4. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1996q4 | 1996 |       4 | .55639912 | .49887649 |  .15237911 |  .80256418 |  .15828993 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     |     5.48 | 4.343401 | 5.066803 | 5.118791 | .0086498 | .0064034 | 5.333333 | .48211903 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .44501452                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
  5. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1997q1 | 1997 |       1 | .54642597 | .48424696 |  .33321874 | -4.4526498 |   .3023814 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 5.646667 | 4.362312 | 5.072879 | 5.124558 | .0060759 | .0057673 | 5.233333 | .47472963 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .44305942                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
  6. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1997q2 | 1997 |       2 | .55785435 | .49735394 |  .19591498 | -.53291956 | -.07923579 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     |     5.85 | 4.376868 | 5.075173 | 5.130884 | .0022945 | .0063257 |        5 | .47345289 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .44555976                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
  7. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1997q3 | 1997 |       3 | .56695318 | .50885453 |  .14971218 |  .57474204 | -.12677552 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     |     5.54 | 4.399949 | 5.080159 | 5.135209 | .0049858 | .0043254 | 4.866667 | .47236631 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .44213179                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
  8. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1997q4 | 1997 |       4 | .54984284 | .49451624 | -.22458995 | -2.5309945 |  -.2951791 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 5.483334 | 4.424819 | 5.085536 | 5.140882 | .0053773 | .0056734 | 4.666667 | .47498209 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .44150127                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
  9. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1998q1 | 1998 |       1 | .55603067 | .49286135 |  .04669203 | -1.7266199 |  1.4935128 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 5.313333 | 4.435836 | 5.087596 | 5.146912 | .0020599 | .0060296 | 4.633333 | .47864468 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .43974221                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
 10. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 1998q2 | 1998 |       2 | .57069699 | .50973879 | -.35200908 | -.43573239 |  .15393381 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     |     5.41 | 4.442409 | 5.090882 | 5.152519 | .0032854 | .0056071 |      4.4 | .47534157 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .43696457                                        |
     +----------------------------------------------------------------------------------------+

. if `n_final' > 10 {
.     display _n "Last 10 observations:"

Last 10 observations:
.     list in `=`n_final'-9'/`n_final'

     +----------------------------------------------------------------------------------------+
103. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2021q3 | 2021 |       3 | .58081106 | .51128158 | -.27989836 |  2.5936906 | -.71784132 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | .0766667 | 4.602325 | 5.609051 | 5.631673 | .0159225 | .0128717 | 5.066667 | .48531073 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .45746486                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
104. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2021q4 | 2021 |       4 | .56104589 |  .4941321 |  .91520046 |  .05333804 |   .1080382 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | .1966667 | 4.610566 | 5.630186 | 5.646942 | .0211349 | .0152688 |      4.2 | .48100253 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .45328173                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
105. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2022q1 | 2022 |       1 | .56151048 |  .4920461 | -.37518262 |    5.75685 | -.81347367 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | .9633334 | 4.613069 | 5.651919 |  5.66307 | .0217333 | .0161281 | 3.833333 | .47879043 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .45564455                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
106. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2022q2 | 2022 |       2 | .55958433 | .49410154 | -.03607096 |  1.6260728 | -.83130764 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     |      2.2 | 4.617728 | 5.675516 | 5.677337 | .0235972 | .0142674 | 3.633333 | .48527403 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .45941147                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
107. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2022q3 | 2022 |       3 | .56590725 | .49909802 |  .16599138 | -1.1559269 |  .57953785 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 3.396667 | 4.617135 | 5.688692 | 5.692535 |  .013176 | .0151982 | 3.533333 | .48338702 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .46019374                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
108. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2022q4 | 2022 |       4 |  .5648933 | .49522039 | -.46528938 | -.56327645 |  -.5842276 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 4.613333 |  4.61171 | 5.698764 | 5.705033 | .0100718 | .0124979 | 3.566667 | .47741898 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .45103259                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
109. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2023q1 | 2023 |       1 |  .5637275 | .49166846 |  .42797086 |  -1.471965 |  .09826106 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 4.766666 | 4.612366 | 5.707746 | 5.716918 | .0089817 | .0118847 | 3.533333 | .48617877 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .45274866                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
110. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2023q2 | 2023 |       2 | .57187048 | .50254818 | -.25151829 |   .6693601 | -.23768009 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 4.943333 | 4.612801 | 5.715131 | 5.728368 | .0073853 | .0114503 | 3.533333 | .47275295 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .44480244                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
111. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2023q3 | 2023 |       3 | .58067498 | .50861322 | -.28728549 |  2.5030403 | -1.0854051 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     | 5.393333 | 4.614351 | 5.723717 | 5.735732 | .0085859 | .0073638 | 3.666667 | .48360981 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                        .4459636                                        |
     +----------------------------------------------------------------------------------------+

     +----------------------------------------------------------------------------------------+
112. |  qdate | year | quarter | gini_core | gini_br~d | demand_s~g | demand_s~l | supply_s~k |
     | 2023q4 | 2023 |       4 | .56300383 | .49200142 |  .03643316 | -2.9591179 |  .24835329 |
     |----------------------------------------------------------------------------------------|
     | treasu~r | log_in~o | log_c~ne | log_c~re | infl_h~e | infl_c~e |   unrate | gini_fi~x |
     |     5.22 | 4.611601 | 5.730613 | 5.744107 |  .006896 | .0083747 |      3.8 | .49226489 |
     |----------------------------------------------------------------------------------------|
     |                                       gini_fs~x                                        |
     |                                       .45652635                                        |
     +----------------------------------------------------------------------------------------+
. }

. 
. display _n "Final dataset saved: $deriv/gini_bh_shocks_fred_merged.dta"

Final dataset saved: /Volumes/SSD PRO/Github-forks/Chp3-EnergyIneq/Code/Data/CEX/derived/gini_b
> h_shocks_fred_merged.dta

. 
. ****************************************************
. * 8. COMPREHENSIVE VARIABLE SUMMARY FOR FINAL DATASET
. * This section provides a complete inventory of all variables
. * in the final merged dataset for documentation purposes
. ****************************************************
. 
. display _n _n "========================================"


========================================

. display "COMPREHENSIVE VARIABLE SUMMARY"
COMPREHENSIVE VARIABLE SUMMARY

. display "Final Dataset: gini_bh_shocks_fred_merged.dta"
Final Dataset: gini_bh_shocks_fred_merged.dta

. display "========================================" _n
========================================


. 
. * Load final dataset to ensure we're working with it
. use "$deriv/gini_bh_shocks_fred_merged.dta", clear

. 
. display _n "=== DATASET OVERVIEW ==="

=== DATASET OVERVIEW ===

. count
  112

. display "Total observations: " r(N)
Total observations: 112

. display "Date range:"
Date range:

. summarize qdate

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       qdate |        112       199.5    32.47563        144        255

. quietly {

. display "First observation: " %tq `first_date'
First observation: 1996q1

. display "Last observation: " %tq `last_date'
Last observation: 2023q4

. 
. display _n "=== VARIABLE DESCRIPTIONS ==="

=== VARIABLE DESCRIPTIONS ===

. describe, fullnames

Contains data from /Volumes/SSD PRO/Github-forks/Chp3-EnergyIneq/Code/Data/CEX/derived/gini_bh_
> shocks_fred_merged.dta
 Observations:           112                  
    Variables:            17                  9 Jan 2026 07:34
-----------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-----------------------------------------------------------------------------------------------
qdate           float   %tq                   Stata quarterly date
year            float   %8.0g                 Year
quarter         float   %8.0g                 Quarter (. = annual)
gini_core       double  %10.0g                Gini coefficient - core consumption
gini_broad      double  %10.0g                Gini coefficient - broad consumption
demand_shock_agg
                double  %10.0g                BH aggregate demand shock (economic activity)
demand_shock_oil
                double  %10.0g                BH oil consumption demand shock (oil market)
supply_shock    double  %10.0g                BH supply shock
treasury_1yr    float   %9.0g                 1-year Treasury yield (%)
log_indpro      float   %9.0g                 Log Industrial Production (quarterly average)
log_cpi_headline
                float   %9.0g                 Log Headline CPI (quarterly average)
log_cpi_core    float   %9.0g                 Log Core CPI (quarterly average)
infl_headline   float   %9.0g                 Headline inflation (quarterly, log difference)
infl_core       float   %9.0g                 Core inflation (quarterly, log difference)
unrate          float   %9.0g                 Unemployment rate (%)
gini_fincbtax   double  %10.0g                Gini coefficient - income before taxes
gini_fsalaryx   double  %10.0g                Gini coefficient - salary income
-----------------------------------------------------------------------------------------------
Sorted by: qdate

. 
. display _n "=== SUMMARY STATISTICS FOR ALL VARIABLES ==="

=== SUMMARY STATISTICS FOR ALL VARIABLES ===

. summarize

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       qdate |        112       199.5    32.47563        144        255
        year |        112      2009.5    8.114052       1996       2023
     quarter |        112         2.5    1.123059          1          4
   gini_core |        112    .5467513    .0279785   .4785634   .5902273
  gini_broad |        112    .4969325    .0129607   .4693763   .5317876
-------------+---------------------------------------------------------
demand_sho~g |        112    -.022581    .3684091  -1.722556   1.371835
demand_sho~l |        112    .1051334    2.496383  -8.602133    5.75685
supply_shock |        112   -.1404723    .7688119   -3.78646   2.563987
treasury_1yr |        112     2.39878    2.099804        .06   6.216667
  log_indpro |        112    4.550063    .0771459   4.294415   4.644863
-------------+---------------------------------------------------------
log_cpi_he~e |        112    5.364351    .1822432   5.043853   5.730613
log_cpi_core |        112    5.393008    .1683687   5.100068   5.744107
infl_headl~e |        111     .006187    .0058752  -.0232277   .0235972
   infl_core |        111    .0058022    .0030702  -.0051718   .0171204
      unrate |        112    5.622321    1.859771   3.533333         13
-------------+---------------------------------------------------------
gini_fincb~x |        112     .475651    .0118051   .4469833   .5007025
gini_fsala~x |        112    .4478432     .008583   .4269168   .4737223

. 
. display _n "=== VARIABLE-BY-VARIABLE DETAILED SUMMARY ==="

=== VARIABLE-BY-VARIABLE DETAILED SUMMARY ===

. * Get list of all variables
. quietly ds

. local varlist `r(varlist)'

. 
. foreach var of local varlist {
  2.     display _n "----------------------------------------"
  3.     display "Variable: `var'"
  4.     
.     * Get variable label
.     local varlabel : variable label `var'
  5.     if "`varlabel'" != "" {
  6.         display "Label: `varlabel'"
  7.     }
  8.     else {
  9.         display "Label: (no label)"
 10.     }
 11.     
.     * Get variable type and format
.     quietly describe `var'
 12.     local vartype = r(type)
 13.     local varformat = r(format)
 14.     display "Type: `vartype'"
 15.     display "Format: `varformat'"
 16.     
.     * Count non-missing and missing
.     quietly count if !missing(`var')
 17.     local n_nonmiss = r(N)
 18.     quietly count if missing(`var')
 19.     local n_miss = r(N)
 20.     local n_total = `n_nonmiss' + `n_miss'
 21.     display "Total observations: `n_total'"
 22.     display "Non-missing: `n_nonmiss' (" %5.2f = 100*`n_nonmiss'/`n_total' "%)"
 23.     display "Missing: `n_miss' (" %5.2f = 100*`n_miss'/`n_total' "%)"
 24.     
.     * Summary statistics for numeric variables
.     capture confirm numeric variable `var'
 25.     if _rc == 0 {
 26.         quietly summarize `var', detail
 27.         if r(N) > 0 {
 28.             display "Mean: " %12.4f = r(mean)
 29.             display "Std Dev: " %12.4f = r(sd)
 30.             display "Min: " %12.4f = r(min)
 31.             display "P25: " %12.4f = r(p25)
 32.             display "Median: " %12.4f = r(p50)
 33.             display "P75: " %12.4f = r(p75)
 34.             display "Max: " %12.4f = r(max)
 35.         }
 36.         else {
 37.             display "All values are missing"
 38.         }
 39.     }
 40.     else {
 41.         * For string variables, note that it's a string type
.         display "String variable - detailed statistics not computed"
 42.         quietly count if !missing(`var')
 43.         if r(N) > 0 {
 44.             display "Sample values (first 3 non-missing):"
 45.             preserve
 46.             quietly keep if !missing(`var')
 47.             quietly keep in 1/3
 48.             quietly list `var', noobs clean
 49.             restore
 50.         }
 51.     }
 52. }

----------------------------------------
Variable: qdate
Label: Stata quarterly date
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:     199.5000
Std Dev:      32.4756
Min:     144.0000
P25:     171.5000
Median:     199.5000
P75:     227.5000
Max:     255.0000

----------------------------------------
Variable: year
Label: Year
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:    2009.5000
Std Dev:       8.1141
Min:    1996.0000
P25:    2002.5000
Median:    2009.5000
P75:    2016.5000
Max:    2023.0000

----------------------------------------
Variable: quarter
Label: Quarter (. = annual)
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       2.5000
Std Dev:       1.1231
Min:       1.0000
P25:       1.5000
Median:       2.5000
P75:       3.5000
Max:       4.0000

----------------------------------------
Variable: gini_core
Label: Gini coefficient - core consumption
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       0.5468
Std Dev:       0.0280
Min:       0.4786
P25:       0.5336
Median:       0.5574
P75:       0.5669
Max:       0.5902

----------------------------------------
Variable: gini_broad
Label: Gini coefficient - broad consumption
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       0.4969
Std Dev:       0.0130
Min:       0.4694
P25:       0.4877
Median:       0.4974
P75:       0.5069
Max:       0.5318

----------------------------------------
Variable: demand_shock_agg
Label: BH aggregate demand shock (economic activity)
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:      -0.0226
Std Dev:       0.3684
Min:      -1.7226
P25:      -0.2038
Median:      -0.0026
P75:       0.1311
Max:       1.3718

----------------------------------------
Variable: demand_shock_oil
Label: BH oil consumption demand shock (oil market)
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       0.1051
Std Dev:       2.4964
Min:      -8.6021
P25:      -1.2783
Median:       0.3217
P75:       1.7306
Max:       5.7569

----------------------------------------
Variable: supply_shock
Label: BH supply shock
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:      -0.1405
Std Dev:       0.7688
Min:      -3.7865
P25:      -0.5599
Median:      -0.1384
P75:       0.2521
Max:       2.5640

----------------------------------------
Variable: treasury_1yr
Label: 1-year Treasury yield (%)
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       2.3988
Std Dev:       2.0998
Min:       0.0600
P25:       0.3500
Median:       1.8917
P75:       4.6483
Max:       6.2167

----------------------------------------
Variable: log_indpro
Label: Log Industrial Production (quarterly average)
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       4.5501
Std Dev:       0.0771
Min:       4.2944
P25:       4.5068
Median:       4.5773
P75:       4.6111
Max:       4.6449

----------------------------------------
Variable: log_cpi_headline
Label: Log Headline CPI (quarterly average)
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       5.3644
Std Dev:       0.1822
Min:       5.0439
P25:       5.2056
Median:       5.3814
P75:       5.4930
Max:       5.7306

----------------------------------------
Variable: log_cpi_core
Label: Log Core CPI (quarterly average)
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       5.3930
Std Dev:       0.1684
Min:       5.1001
P25:       5.2583
Median:       5.3968
P75:       5.5221
Max:       5.7441

----------------------------------------
Variable: infl_headline
Label: Headline inflation (quarterly, log difference)
Type: .
Format: .
Total observations: 112
Non-missing: 111 (99.11%)
Missing: 1 ( 0.89%)
Mean:       0.0062
Std Dev:       0.0059
Min:      -0.0232
P25:       0.0038
Median:       0.0065
P75:       0.0086
Max:       0.0236

----------------------------------------
Variable: infl_core
Label: Core inflation (quarterly, log difference)
Type: .
Format: .
Total observations: 112
Non-missing: 111 (99.11%)
Missing: 1 ( 0.89%)
Mean:       0.0058
Std Dev:       0.0031
Min:      -0.0052
P25:       0.0044
Median:       0.0053
P75:       0.0064
Max:       0.0171

----------------------------------------
Variable: unrate
Label: Unemployment rate (%)
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       5.6223
Std Dev:       1.8598
Min:       3.5333
P25:       4.3167
Median:       5.0500
P75:       6.1333
Max:      13.0000

----------------------------------------
Variable: gini_fincbtax
Label: Gini coefficient - income before taxes
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       0.4757
Std Dev:       0.0118
Min:       0.4470
P25:       0.4680
Median:       0.4760
P75:       0.4835
Max:       0.5007

----------------------------------------
Variable: gini_fsalaryx
Label: Gini coefficient - salary income
Type: .
Format: .
Total observations: 112
Non-missing: 112 (100.00%)
Missing: 0 ( 0.00%)
Mean:       0.4478
Std Dev:       0.0086
Min:       0.4269
P25:       0.4422
Median:       0.4476
P75:       0.4534
Max:       0.4737

. 
. display _n _n "========================================"


========================================

. display "END OF VARIABLE SUMMARY"
END OF VARIABLE SUMMARY

. display "========================================" _n
========================================


. 
. * Close log file
. log close
      name:  <unnamed>
       log:  /Volumes/SSD PRO/Github-forks/Chp3-EnergyIneq/Code/05_merge_fred_data.log
  log type:  text
 closed on:   9 Jan 2026, 07:34:08
-----------------------------------------------------------------------------------------------
